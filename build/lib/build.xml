<?xml version="1.0"?>
<!-- ====================================================================== 
     Dec 13, 2006 11:33:32 AM                                                        

     OpenSCADA Atlantis Build Tools File    
     Providing common build targets for all other ant-scripts
                   
     jens                                                                
     ====================================================================== -->
<project name="OpenSCADA Atlantis Build Tools File" default="default">
    <description>
            Providing common build targets for all other ant-scripts
    </description>
	
	<!-- ================================= 
          target: default              
         ================================= -->
    <target name="default" description="--> Nothing">
    </target>
	
	<!-- - - - - - - - - - - - - - - - - - 
          macrodef: openscada.pull-in-lib
          Unpack a deployed archive and copy the libraries into the build-lib folder
         - - - - - - - - - - - - - - - - - -->
    <macrodef name="openscada.pull-in-lib">
    	<attribute name="name"/>
    	<sequential>
	    	<mkdir dir="${build.dir}/lib"/>
	    	<unzip src="${deploy.dir}/@{name}.zip" dest="${build.dir}">
	    		<patternset>
	    			<include name="lib/*.jar"/>
	    		</patternset>
	   		</unzip>
    	</sequential>
    </macrodef>
	
	<!-- = = = = = = = = = = = = = = = = =
          macrodef: openscada.pull-in-external-lib          
         = = = = = = = = = = = = = = = = = -->
    <macrodef name="openscada.pull-in-external-lib">
        <attribute name="name"/>
        <sequential>
            <openscada.pull-in-lib name="external-@{name}"/>
        </sequential>
    </macrodef>

	
	<!-- - - - - - - - - - - - - - - - - - 
          macrodef: openscada.prepare-local-libs  
          Copy the local libraries into the build-lib folder                    
         - - - - - - - - - - - - - - - - - -->
    <macrodef name="openscada.prepare-local-libs">
    	<sequential>
			<copy todir="${build.dir}/lib" failonerror="false">
				<fileset dir="lib">
					<exclude name="**/.svn"/>
				</fileset>
	    	</copy>
    	</sequential>
    </macrodef>

	<!-- = = = = = = = = = = = = = = = = =
          macrodef: openscada.export.license          
         = = = = = = = = = = = = = = = = = -->
    <macrodef name="openscada.export.license">
        <sequential>
    		<copy file="COPYING" todir="${build.dir}"/>
        </sequential>
    </macrodef>
	
	<!-- = = = = = = = = = = = = = = = = =
          macrodef: openscada.export.source          
         = = = = = = = = = = = = = = = = = -->
    <macrodef name="openscada.export.source">
        <sequential>
    		<mkdir dir="${build.dir}/src"/>
    		<copy todir="${build.dir}/src">
    			<fileset dir="src">
    				<include name="**/*.java"/>
    				<exclude name="**/.svn"/>
    			</fileset>
    		</copy>
        </sequential>
    </macrodef>

	<!-- = = = = = = = = = = = = = = = = =
          macrodef: openscada.compile.javadoc          
         = = = = = = = = = = = = = = = = = -->
    <macrodef name="openscada.compile.javadoc">
        <sequential>
    	   	<mkdir dir="${build.dir}/docs/api"/>
      		<javadoc destdir="${build.dir}/docs/api"
    	       	author="true"
    	       	version="true"
    	       	use="true"
    	       	encoding="utf-8"
    	       	>
    	       	<tag name="note" description="Note" scope="all"/>
    	       	<tag name="warning" description="Warning" scope="all"/>
    	       	<packageset dir="src" defaultexcludes="yes">
    	       		<include name="**"/>
    	       	</packageset>
    			<classpath>
    				<fileset dir="${build.dir}/lib">
    					<include name="*.jar"/>
    				</fileset>
    	  		</classpath>
    		</javadoc>
        </sequential>
    </macrodef>

	<!-- = = = = = = = = = = = = = = = = =
          macrodef: openscada.compile.source          
         = = = = = = = = = = = = = = = = = -->
    <macrodef name="openscada.compile.source">
        <sequential>
    		<mkdir dir="bin"/>
    		<javac
    			encoding="utf-8"
    			source="1.5"
    			target="1.5"
    			srcdir="src"
    			destdir="bin"
    			>
    			<classpath>
    				<fileset dir="${build.dir}/lib">
    					<include name="**/*.jar"/>
    				</fileset>
    			</classpath>
    		</javac>
        </sequential>
    </macrodef>
	
	<!-- = = = = = = = = = = = = = = = = =
          macrodef: openscada.common.build          
         = = = = = = = = = = = = = = = = = -->
    <macrodef name="openscada.common.build">
        <sequential>
    		<openscada.compile.source/>
    		<openscada.compile.javadoc/>
    		<openscada.export.source/>
    		<openscada.export.license/>
        </sequential>
    </macrodef>


</project>
