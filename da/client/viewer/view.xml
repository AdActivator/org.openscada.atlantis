<?xml version="1.0" encoding="UTF-8"?>

<viewer:root
  xmlns:common="http://openscada.org/Common"
  xmlns:viewer="http://openscada.org/DA/Viewer"
  xmlns:template="http://openscada.org/DA/Viewer/Template"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://openscada.org/DA/Viewer schema/Viewer.xsd http://openscada.org/Common http://schema.openscada.org/Common.xsd http://openscada.org/DA/Viewer/Template schema/TemplateObject.xsd"
  >
  
	<factories>
		<container-factory id="figure" class="org.openscada.da.client.viewer.model.impl.containers.FigureContainerFactory"/>
		<container-factory id="view" class="org.openscada.da.client.viewer.model.impl.containers.BasicViewFactory"/>
		<container-factory id="hidden" class="org.openscada.da.client.viewer.model.impl.containers.HiddenContainerFactory"/>
		<container-factory id="command" class="org.openscada.da.client.viewer.model.impl.containers.CommandContainer"/>
		
		<object-factory id="rectangle" class="org.openscada.da.client.viewer.model.impl.figures.RectangleFactory"/>
		<object-factory id="triangle" class="org.openscada.da.client.viewer.model.impl.figures.Triangle"/>
		<object-factory id="item" class="org.openscada.da.client.viewer.model.impl.items.DataItemObject"/>
		
		<object-factory id="colorcomposer" class="org.openscada.da.client.viewer.model.impl.converter.ColorComposer"/>
		<object-factory id="modulo" class="org.openscada.da.client.viewer.model.impl.converter.ModuloCalculator"/>
		<object-factory id="factor" class="org.openscada.da.client.viewer.model.impl.converter.FactorCalculator"/>
		
		<object-factory id="variantasboolean" class="org.openscada.da.client.viewer.model.impl.converter.VariantBooleanConverter"/>
		<object-factory id="variantasinteger" class="org.openscada.da.client.viewer.configurator.xml.XMLObjectFactory">
			<arg class="org.openscada.da.client.viewer.model.impl.converter.SimpleVariantIntegerConverter"/>
		</object-factory>
		<object-factory id="variantasdouble" class="org.openscada.da.client.viewer.configurator.xml.XMLObjectFactory">
			<arg class="org.openscada.da.client.viewer.model.impl.converter.SimpleVariantDoubleConverter"/>
		</object-factory>
		<object-factory id="d2i" class="org.openscada.da.client.viewer.configurator.xml.XMLObjectFactory">
			<arg class="org.openscada.da.client.viewer.model.impl.converter.Double2IntegerConverter"/>
		</object-factory>
		
		<object-factory id="boolean2matrix" class="org.openscada.da.client.viewer.model.impl.converter.Boolean2Matrix"/>

		<object-factory id="mov-cmd" class="org.openscada.da.client.viewer.configurator.xml.XMLTemplateFactory">
			<template:template id="mov-cmd" type="figure">
				<objects>					
					<container type="command" id="c1">
						<property name="commands">open-command|Open,close-command|Close</property>
		
						<objects>
							<template-object template="mov" id="mov1"/>
						</objects>
						
						<connectors>
						</connectors>
						
						<inputs>
							<input-export object="mov1" name="open-signal" export-name="open-signal"/>
							<input-export object="mov1" name="close-signal" export-name="close-signal"/>
						</inputs>
						
					</container>
				</objects>

				<connectors>
				</connectors>

				<outputs>
					<output-export object="c1" name="open-command" export-name="open-command"/>
					<output-export object="c1" name="close-command" export-name="close-command"/>
				</outputs>

				<inputs>
					<input-export object="c1" name="open-signal" export-name="open-signal"/>
					<input-export object="c1" name="close-signal" export-name="close-signal"/>
				</inputs>
				
			</template:template>
		</object-factory>
				
		<object-factory id="mov" class="org.openscada.da.client.viewer.configurator.xml.XMLTemplateFactory">
			<template:template id="mov" type="figure">

				<objects>
					<constant id="mov_fatal"><color red="255" green="0" blue="255"/></constant>
					<constant id="mov_opened"><color red="0" green="255" blue="0"/></constant>
					<constant id="mov_transit"><color red="255" green="255" blue="0"/></constant>
					<constant id="mov_closed"><null/></constant>
					<constant id="mov_error"><color red="255" green="0" blue="0"/></constant>
					
					<object type="rectangle" id="rect1">
						<property name="x">0</property>
						<property name="y">0</property>
						<property name="width">24</property>
						<property name="height">24</property>
					</object>
					<object type="triangle" id="tri1">
						<property name="x">2</property>
						<property name="y">2</property>
						<property name="width">10</property>
						<property name="height">20</property>
						<property name="direction">2</property>
					</object>
					<object type="triangle" id="tri2">
						<property name="x">12</property>
						<property name="y">2</property>
						<property name="width">10</property>
						<property name="height">20</property>
						<property name="direction">8</property>
					</object>
					<object type="boolean2matrix" id="oc_matrix_1"/>
					<object type="variantasboolean" id="v2b_opened"/>
					<object type="variantasboolean" id="v2b_closed"/>

				</objects>
				<connectors>
					<connector type="default">
						<output object="mov_fatal" name="value"/>
						<input object="oc_matrix_1" name="defaultValue"/>
					</connector>
					<connector type="default">
						<output object="mov_transit" name="value"/>
						<input object="oc_matrix_1" name="value00"/>
					</connector>
					<connector type="default">
						<output object="mov_opened" name="value"/>
						<input object="oc_matrix_1" name="value01"/>
					</connector>
					<connector type="default">
						<output object="mov_closed" name="value"/>
						<input object="oc_matrix_1" name="value10"/>
					</connector>
					<connector type="default">
						<output object="mov_error" name="value"/>
						<input object="oc_matrix_1" name="value11"/>
					</connector>
					<connector type="default">
						<output object="oc_matrix_1" name="value"/>
						<input object="tri1" name="color"/>
					</connector>
					<connector type="default">
						<output object="oc_matrix_1" name="value"/>
						<input object="tri2" name="color"/>
					</connector>
					
					<connector type="default">
						<output object="v2b_opened" name="value"/>
						<input object="oc_matrix_1" name="valueA"/>
					</connector>
					<connector type="default">
						<output object="v2b_closed" name="value"/>
						<input object="oc_matrix_1" name="valueB"/>
					</connector>
					
				</connectors>
				<outputs>
				</outputs>
				
				<inputs>
					<input-export object="v2b_opened" name="value" export-name="open-signal"/>
					<input-export object="v2b_closed" name="value" export-name="close-signal"/>
				</inputs>
				
			</template:template>
		</object-factory>
		
		<object-factory id="variant_cc" class="org.openscada.da.client.viewer.configurator.xml.XMLTemplateFactory">
			<template:template id="variant_cc" type="hidden">
				<objects>
					<object type="colorcomposer" id="cc">
						<property name="red">0</property>
						<property name="green">0</property>
						<property name="blue">0</property>
					</object>
					<object type="variantasinteger" id="vai_r"/>
					<object type="variantasinteger" id="vai_g"/>
					<object type="variantasinteger" id="vai_b"/>
					<object type="modulo" id="mod_r"><property name="modulo">255</property></object>
					<object type="modulo" id="mod_g"><property name="modulo">255</property></object>
					<object type="modulo" id="mod_b"><property name="modulo">255</property></object>
				</objects>
				
				<connectors>
				
					<connector type="default">
						<output object="vai_r" name="value"/>
						<input object="mod_r" name="value"/>
					</connector>
					<connector type="default">
						<output object="mod_r" name="value"/>
						<input object="cc" name="red"/>
					</connector>
					
					<connector type="default">
						<output object="vai_g" name="value"/>
						<input object="mod_g" name="value"/>
					</connector>
					<connector type="default">
						<output object="mod_g" name="value"/>
						<input object="cc" name="green"/>
					</connector>
					
					<connector type="default">
						<output object="vai_b" name="value"/>
						<input object="mod_b" name="value"/>
					</connector>
					<connector type="default">
						<output object="mod_b" name="value"/>
						<input object="cc" name="blue"/>
					</connector>
					
				</connectors>
				<outputs>
					<output-export object="cc" name="color" export-name="color"/>
				</outputs>
				<inputs>
					<input-export object="vai_r" name="value" export-name="red"/>
					<input-export object="vai_g" name="value" export-name="green"/>
					<input-export object="vai_b" name="value" export-name="blue"/>
				</inputs>
			</template:template>
		</object-factory>
		<connector-factory id="default" class="org.openscada.da.client.viewer.model.impl.PassThroughConnectorFactory"/>
		<connector-factory id="display" class="org.openscada.da.client.viewer.model.impl.DisplaySynchronizedConnectorFactory"/>
	</factories>
	
	<views>
		<view id="view1" type="view">
			
			<objects>
				
				<object id="mov1_cmd_open" type="item">
					<property name="item">mov.1000.open-command</property>
					<property name="connection">net://localhost:1202</property>
				</object>
				<object id="mov1_cmd_close" type="item">
					<property name="item">mov.1000.close-command</property>
					<property name="connection">net://localhost:1202</property>
				</object>

				<object id="mov1_open" type="item">
					<property name="item">mov.1000.open-signal</property>
					<property name="connection">net://localhost:1202</property>
				</object>
				<object id="mov1_close" type="item">
					<property name="item">mov.1000.close-signal</property>
					<property name="connection">net://localhost:1202</property>
				</object>
			
				<template-object template="mov-cmd" id="mov-cmd-1">
					<property name="x">0</property>
					<property name="y">0</property>
				</template-object>
			
				<template-object template="mov-cmd" id="mov-cmd-2">
					<property name="x">100</property>
					<property name="y">100</property>
				</template-object>
				
			</objects>
			
			<connectors>
			
				<connector type="display">
					<output object="mov1_open" name="value"/>
					<input object="mov-cmd-1" name="open-signal"/>
				</connector>
				<connector type="display">
					<output object="mov1_close" name="value"/>
					<input object="mov-cmd-1" name="close-signal"/>
				</connector>
				<connector type="default">
					<output object="mov-cmd-1" name="open-command"/>
					<input object="mov1_cmd_open" name="value"/>
				</connector>
				<connector type="default">
					<output object="mov-cmd-1" name="close-command"/>
					<input object="mov1_cmd_close" name="value"/>
				</connector>
				
			</connectors>
		</view>
	</views>
</viewer:root>