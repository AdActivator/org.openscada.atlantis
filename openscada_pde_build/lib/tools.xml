<?xml version="1.0"?>

<project name="tools project">
	
	<import file="${libfile}"/>
	
	<macrodef name="exportSvn">
		<attribute name="todir"/>
		<attribute name="module"/>
		
		<sequential>
			<mkdir dir="@{todir}"/>
			<svn>
				<export force="true" srcUrl="@{module}" destPath="@{todir}"/>
			</svn>
		</sequential>

	</macrodef>

	<target name="checkoutSvn">
		<exportSvn module="${module}" todir="${todir}"/>
	</target>
	
	<!-- = = = = = = = = = = = = = = = = =
          macrodef: fetch-module          
         = = = = = = = = = = = = = = = = = -->
    <macrodef name="fetch-module">
        <attribute name="type" default="plugin" />
    	<attribute name="name"/>
    	<attribute name="src"/>
    	
        <sequential>
        	<!-- ${buildDirectory}/plugins/org.openscada.da.client.test -->
        	<exportSvn module="@{src}" todir="${buildDirectory}/@{type}s/@{name}"/>
        	<prepare-module name="@{name}" type="@{type}"/>
        </sequential>
    </macrodef>
	
	<!-- = = = = = = = = = = = = = = = = =
          macrodef: prepare-module
          Run the support-build.xml file is it exists
         = = = = = = = = = = = = = = = = = -->
    <macrodef name="prepare-module">
        <attribute name="type" default="plugin" />
    	<attribute name="name"/>
        <sequential>
        	<if>
        		<available type="file" file="${buildDirectory}/@{type}s/@{name}/support-build.xml"/>
        		<then>
        			<ant antfile="${buildDirectory}/@{type}s/@{name}/support-build.xml" dir="${buildDirectory}/@{type}s/@{name}">
        				<property name="use.maven.dependencies" value="true"/>
        			</ant>
        		</then>
        	</if>
		</sequential>
    </macrodef>
	
</project>